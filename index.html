<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Norton&#39;s Blog | You miss 100% of the shot you do not take.</title>

  
  <meta name="author" content="王谱越">
  

  

  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  

  <meta property="og:site_name" content="Norton&#39;s Blog"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Norton&#39;s Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
</head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">Norton&#39;s Blog</a>
    </h1>
    <p class="site-description">You miss 100% of the shot you do not take.</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">主页</a></li>
      
        <li><a href="/archives">归档</a></li>
      
        <li><a href="/categories">分类</a></li>
      
        <li><a href="/tags">标签</a></li>
      
        <li><a href="/about">关于</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    
  <article>

  
    
    <h3 class="article-title"><a href="/2019/03/21/malloc-calloc-realloc/"><span>malloc、calloc、realloc的区别</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/03/21/malloc-calloc-realloc/" rel="bookmark">
        <time class="entry-date published" datetime="2019-03-21T15:01:04.000Z">
          2019-03-21
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="函数原型："><a href="#函数原型：" class="headerlink" title="函数原型："></a>函数原型：</h1><h2 id="1-malloc"><a href="#1-malloc" class="headerlink" title="1. malloc"></a>1. malloc</h2><p>​    <code>void* malloc(unsigned size);</code></p>
<p>​    在堆内存中分配一块长度为size字节的连续区域，参数size为需要内存空间的长度。</p>
<h2 id="2-calloc"><a href="#2-calloc" class="headerlink" title="2. calloc"></a>2. calloc</h2><p>​    <code>void* calloc(size_t numElements, size_t sizeOfElement);</code></p>
<p>​    与malloc相似，参数sizeOfElement为单位元素长度（例如：sizeof(int)），numElements为元素个数，即在内存中申请numElements * sizeOfElement字节大小的连续内存空间。</p>
<h2 id="3-realloc"><a href="#3-realloc" class="headerlink" title="3. realloc"></a>3. realloc</h2><p>​    <code>void* realloc(void* ptr, unsigned newsize);</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用realloc函数为ptr重新分配大小为size的一块内存空间。下面是这个函数的工作流程：</span><br></pre></td></tr></table></figure>
<p>​    (1)，对ptr进行判断，如果ptr为NULL，则函数相当于malloc(new_size)，试着分配一块大小为new_size的内存，如果成功将地址返回，否则返回NULL。如果ptr不为NULL，则进入(2)。<br>​    (2)，查看ptr是不是在堆中，如果不是的话会抛出realloc invalid pointer异常。如果ptr在堆中，则查看new_size大小，如果new_size大小为0，则相当于free(ptr)，将ptr指向的内存空间释放掉，返回NULL。如果new_size小于原大小，则ptr中的数据可能会丢失，只有new_size大小的数据会保存；如果size等于原大小，等于什么都没有做；如果size大于原大小，则查看ptr指向的位置还有没有足够的连续内存空间，如果有的话，分配更多的空间，返回的地址和ptr相同，如果没有的话，在更大的空间内查找，如果找到size大小的空间，将旧的内容拷贝到新的内存中，把旧的内存释放掉，则返回新地址，否则返回NULL。</p>
<h1 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h1><ul>
<li>函数malloc不能初始化所分配的内存空间,而函数calloc能.如果由malloc()函数分配的内存空间原来没有被使用过，则其中的每一位可能都是0;反之, 如果这部分内存曾经被分配过,则其中可能遗留有各种各样的数据.也就是说，使用malloc()函数的程序开始时(内存空间还没有被重新分配)能正常进行,但经过一段时间(内存空间还已经被重新分配)可能会出现问题.</li>
<li>函数calloc() 会将所分配的内存空间中的每一位都初始化为零,也就是说,如果你是为字符类型或整数类型的元素分配内存,那么这些元素将保证会被初始化为0;如果你是为指针类型的元素分配内存,那么这些元素通常会被初始化为空指针;如果你为实型数据分配内存,则这些元素会被初始化为浮点型的零.</li>
<li>函数malloc向系统申请分配指定size个字节的内存空间.返回类型是 void<em>类型.void</em>表示未确定类型的指针.C,C++规定，void* 类型可以强制转换为任何其它类型的指针.</li>
<li>realloc可以对给定的指针所指的空间进行扩大或者缩小，无论是扩张或是缩小，原有内存的中内容将保持不变.当然，对于缩小，则被缩小的那一部分的内容会丢失.realloc并不保证调整后的内存空间和原来的内存空间保持同一内存地址.相反，realloc返回的指针很可能指向一个新的地址.</li>
<li>realloc是从堆上分配内存的.当扩大一块内存空间时，realloc()试图直接从堆上现存的数据后面的那些字节中获得附加的字节，如果能够满足，自然天下太平；如果数据后面的字节不够，问题就出来了，那么就使用堆上第一个有足够大小的自由块，现存的数据然后就被拷贝至新的位置，而老块则放回到堆上.这句话传递的一个重要的信息就是数据可能被移动.</li>
</ul>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/知识辨析/">知识辨析</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/C-C/">C/C++</a><a href="/tags/指针/">指针</a><a href="/tags/malloc/">malloc</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/03/18/malocandnew/"><span>malloc 和new</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/03/18/malocandnew/" rel="bookmark">
        <time class="entry-date published" datetime="2019-03-17T16:03:00.000Z">
          2019-03-18
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>​    malloc() 与 free()相对应，new/new[]与delete/delete[]相对应，都应配对使用。</p>
<ol>
<li><p><strong>申请内存位置不同</strong></p>
<p>new操作符可以从其他位置上分配内存，不一定局限于堆。</p>
<p>malloc函数从堆上动态分配内存。</p>
</li>
<li><p><strong>返回类型安全性</strong><br>new操作符返回的是对象类型的指针，类型匹配，故类型安全。</p>
<p>malloc函数分配成功返回void*，需要进行强制类型转换。</p>
</li>
<li><p><strong>内存分配失败时的返回值</strong><br>  new分配失败会抛出<code>bac_alloc</code>异常。</p>
<p>  malloc分配内存失败时返回NULL。</p>
</li>
<li><p><strong>空间大小指定方式不同</strong><br>  new 会根据类型推断需要分配的内存的大小。</p>
<pre><code>malloc需要自行计算指出内存大小。
</code></pre></li>
<li><p><strong>分配行为不同</strong><br>  new分配内存会有3个步骤：</p>
<ul>
<li><p>第一步：调用operator new 函数（对于数组是operator new[]）分配一块足够大的，原始的，未命名的内存空间以便存储特定类型的对象。</p>
</li>
<li><p>第二步：编译器运行相应的构造函数以构造对象，并为其传入初值。</p>
</li>
<li><p>第三步：对象构造完成后，返回一个指向该对象的指针。</p>
<p>malloc 只会开辟空间。</p>
</li>
</ul>
</li>
<li><p><strong>对数组的处理</strong><br>  C++提供了new[]与delete[]来专门处理数组类型:</p>
<pre><code>`A * ptr = new A[10];//分配10个A对象`
使用new[]分配的内存必须使用delete[]进行释放：

`delete [] ptr;`
new对数组的支持体现在它会分别调用构造函数函数初始化每一个数组元素，释放对象时为每个对象调用析构函数。注意delete[]要与new[]配套使用，不然会找出数组对象部分释放的现象，造成内存泄漏。

而malloc，它并不知道你在这块内存上要放的数组还是别的东西，反正它就给你一块原始的内存，在给你个内存的地址就完事。所以如果要动态分配一个数组的内存，还需要我们手动自定数组的大小：
</code></pre></li>
<li><p><strong>是否可以被重载</strong></p>
<p>opeartor new /operator delete可以被重载</p>
<p>而malloc/free并不允许重载。</p>
</li>
<li><p><strong>能否直观地重新分配内存</strong></p>
<p>使用malloc分配的内存后，如果在使用过程中发现内存不足，可以使用realloc函数进行内存重新分配实现内存的扩充。realloc先判断当前的指针所指内存是否有足够的连续空间，如果有，原地扩大可分配的内存地址，并且返回原来的地址指针；如果空间不够，先按照新指定的大小分配空间，将原有数据从头到尾拷贝到新分配的内存区域，而后释放原来的内存区域。</p>
<p>new没有。</p>
</li>
<li><p><strong>new与malloc是否可以相互调用</strong></p>
<p>operator new /operator delete的实现可以基于malloc，而malloc的实现不可以去调用new。</p>
</li>
<li><p><strong>客户处理内存分配不足</strong></p>
<p> 在operator new抛出异常以反映一个未获得满足的需求之前，它会先调用一个用户指定的错误处理函数。</p>
<p> 对于malloc，客户并不能够去编程决定内存不足以分配时要干什么事，只能看着malloc返回NULL。</p>
</li>
</ol>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/知识辨析/">知识辨析</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/C-C/">C/C++</a><a href="/tags/指针/">指针</a><a href="/tags/malloc/">malloc</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/03/02/array/"><span>[LeetCode]数组类问题心得小结</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/03/02/array/" rel="bookmark">
        <time class="entry-date published" datetime="2019-03-02T02:54:02.000Z">
          2019-03-02
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="常用方法与函数"><a href="#常用方法与函数" class="headerlink" title="常用方法与函数"></a>常用方法与函数</h1><p>在C++中，常用vector来作为数组容器。因此我们只讨论vector的相关方法与函数。</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>a.empty()</td>
<td>判断a是否为空，空则返回ture,不空则返回false</td>
</tr>
<tr>
<td>a.erase(a.begin()+1,a.begin()+3)</td>
<td>删除a中第1个（从第0个算起）到第2个元素，也就是说删除的元素从a.begin()+1算起（包括它）一直到a.begin()+ 3（不包括它）</td>
</tr>
<tr>
<td>a.size()</td>
<td>返回a中元素的个数</td>
</tr>
<tr>
<td>a.resize(10,2)</td>
<td>将a的现有元素个数调至10个，多则删，少则补，其值为2</td>
</tr>
<tr>
<td>a.swap(b)</td>
<td>b为向量，将a中的元素和b中的元素进行整体性交换</td>
</tr>
<tr>
<td>a.insert(a.begin()+1,3,5)</td>
<td>在a的第1个元素（从第0个算起）的位置插入3个数，其值都为5</td>
</tr>
<tr>
<td>a.insert(a.begin()+1,5)</td>
<td>在a的第1个元素（从第0个算起）的位置插入数值5，如a为1,2,3,4，插入元素后为1,5,2,3,4</td>
</tr>
</tbody>
</table>
<p>C++算法库中提供了许多算法函数可以对vector进行操作，使用时要包含头文件<code>#include&lt;algorithm&gt;</code></p>
<table>
<thead>
<tr>
<th>函数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>sort(a.begin(),a.end())</td>
<td>对a中的从a.begin()（包括它）到a.end()（不包括它）的元素进行从小到大排列</td>
</tr>
<tr>
<td>reverse(a.begin(),a.end());</td>
<td>对a中的从a.begin()（包括它）到a.end()（不包括它）的元素倒置，但不排列，如a中元素为1,3,2,4,倒置后为4,2,3,1</td>
</tr>
<tr>
<td>copy(a.begin(),a.end(),b.begin()+1)</td>
<td>把a中的从a.begin()（包括它）到a.end()（不包括它）的元素复制到b中，从b.begin()+1的位置（包括它）开始复制，覆盖掉原有元素</td>
</tr>
<tr>
<td>find(a.begin(),a.end(),10)</td>
<td>在a中的从a.begin()（包括它）到a.end()（不包括它）的元素中查找10，若存在返回其在向量中的位置</td>
</tr>
</tbody>
</table>
      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/LeetCode-Summary/">LeetCode Summary</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/LeetCode/">LeetCode</a><a href="/tags/数组/">数组</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/02/28/Leetcode-array/"><span>【LeetCode】初级算法——数组</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/02/28/Leetcode-array/" rel="bookmark">
        <time class="entry-date published" datetime="2019-02-28T08:02:10.000Z">
          2019-02-28
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="LeetCode-217-存在重复元素"><a href="#LeetCode-217-存在重复元素" class="headerlink" title="[LeetCode]# 217 存在重复元素"></a>[LeetCode]# 217 存在重复元素</h1><blockquote>
<p>给定一个整数数组，判断是否存在重复元素。</p>
<p>如果任何值在数组中出现至少两次，函数返回 true。如果数组中每个元素都不相同，则返回 false。</p>
<p><strong>示例 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; 输入: [1,2,3,1]</span><br><span class="line">&gt; 输出: true</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p><strong>示例 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; 输入: [1,2,3,4]</span><br><span class="line">&gt; 输出: false</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p><strong>示例 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; 输入: [1,1,1,3,3,4,3,2,4,2]</span><br><span class="line">&gt; 输出: true</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/LeetCode/">LeetCode</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/LeetCode/">LeetCode</a><a href="/tags/数组/">数组</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2019/01/26/bash-变量与表达式/"><span>bash-变量与表达式</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/01/26/bash-变量与表达式/" rel="bookmark">
        <time class="entry-date published" datetime="2019-01-26T06:30:42.000Z">
          2019-01-26
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="Shell变量"><a href="#Shell变量" class="headerlink" title="Shell变量"></a>Shell变量</h1><h2 id="变量定义"><a href="#变量定义" class="headerlink" title="变量定义"></a>变量定义</h2><p>定义变量如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">variable=value</span><br><span class="line">variable='value'</span><br><span class="line">variable="value"</span><br></pre></td></tr></table></figure>
<p>注意，变量名和<code>=</code>之间不能有空格，这可能和你熟悉的所有编程语言都不一样。同时，变量名的命名须遵循如下规则：</p>
<ul>
<li>命名只能使用英文字母，数字和下划线，首个字符不能以数字开头。</li>
<li>中间不能有空格，可以使用下划线（_）。</li>
<li>不能使用标点符号。</li>
<li>不能使用bash里的关键字（可用help命令查看保留关键字）。</li>
</ul>
      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/学习笔记/">-学习笔记</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/Shell/">-Shell</a>
    </span>
    

    </div>

    
  </div>
</article>




<nav class="pagination">
  
  
  <a href="/page/2/" class="pagination-next">下一页</a>
  
</nav>
    </main>

    <footer class="site-footer">
  <div class="social-wrapper">
    
      
        <a href="https://github.com/wangpy1489" class="social github" target="_blank" rel="external">
          <span class="iconfont icon-github"><i class="fab fa-github fa-2x" ></i></span>
        </a>
        
        <a href="https://www.instagram.com/norton_yue/" class="social instagram" target="_blank" rel="external">
          <span class="iconfont icon-instagram"><i class="fab fa-instagram fa-2x" ></i></span>
        </a>
        
        <a href="https://weibo.com/2218602247" class="social weibo" target="_blank" rel="external">
          <span class="iconfont icon-weibo"><i class="fab fa-weibo fa-2x" ></i></span>
        </a>
        
        <a href="http://wpy-blog.oss-cn-shanghai.aliyuncs.com/qrcode_for_gh_87b7f9bafe9b_344.jpg/wpy-blog" class="social weixin" target="_blank" rel="external">
          <span class="iconfont icon-weixin"><i class="fab fa-weixin fa-2x" ></i></span>
        </a>
        
        <a href="tencent://message/?uin=439257530&amp;Site=&amp;Menu=yes" class="social qq" target="_blank" rel="external">
          <span class="iconfont icon-qq"><i class="fab fa-qq fa-2x" ></i></span>
        </a>
        
        <a href="mailto:wangpy1489@sjtu.edu.cn" class="social at" target="_blank" rel="external">
          <span class="iconfont icon-at"><i class="fab fa-at fa-2x" ></i></span>
        </a>
        
    
  </div>
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2019 王谱越
    
  </p>
</footer>
    
  </div>
</div>
</body>
</html>